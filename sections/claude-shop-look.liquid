{% comment %} {%- style -%}
  #shopify-section-{{ section.id }} {
    --section-padding-top: {{ section.settings.padding_top }}px;
    --section-padding-bottom: {{ section.settings.padding_bottom }}px;
  }

  {%- for block in section.blocks -%}
    {%- if block.type == 'look' -%}
      {%- assign dot_inner_rgb = block.settings.dot_inner_color | color_to_rgb | remove: 'rgb(' | remove: ')' -%}
      {%- assign dot_bg_rgb = block.settings.dot_background_color | color_to_rgb | remove: 'rgb(' | remove: ')' -%}
      
      #block-{{ block.id }} {
        --section-dot-inner-background: {{ dot_inner_rgb }};
        --section-dot-background: {{ dot_bg_rgb }};
      }

      /* Position the dots */
      {%- for i in (1..3) -%}
        {%- assign product_setting = 'product_' | append: i -%}
        {%- assign product = block.settings[product_setting] -%}
        {%- if product != blank -%}
          {%- assign desktop_x = 'hotspot_' | append: i | append: '_x' -%}
          {%- assign desktop_y = 'hotspot_' | append: i | append: '_y' -%}
          {%- assign mobile_x = 'hotspot_' | append: i | append: '_mobile_x' -%}
          {%- assign mobile_y = 'hotspot_' | append: i | append: '_mobile_y' -%}
          
          #block-{{ block.id }}-{{ i }} {
            top: {{ block.settings[desktop_y] }}%;
            left: {{ block.settings[desktop_x] }}%;
          }
          
          @media screen and (max-width: 999px) {
            #block-{{ block.id }}-{{ i }} {
              top: {{ block.settings[mobile_y] }}%;
              left: {{ block.settings[mobile_x] }}%;
            }
          }
        {%- endif -%}
      {%- endfor -%}
    {%- endif -%}
  {%- endfor -%}
{%- endstyle -%}

<section class="section section--padding">
  <shop-the-look reveal-on-scroll class="shop-the-look">
    <div class="shop-the-look__item-list">
      {%- for block in section.blocks -%}
        {%- case block.type -%}
          {%- when 'look' -%}
            <shop-the-look-item 
              id="block-{{ block.id }}" 
              class="shop-the-look__item" 
              {% if forloop.first %}style="visibility: visible;"{% else %}hidden style="visibility: hidden;"{% endif %}
              {{ block.shopify_attributes }}>
              
              <div class="shop-the-look__image-wrapper">
                {%- if block.settings.desktop_image != blank -%}
                  {{ block.settings.desktop_image | image_url: width: 2160 | image_tag:
                    loading: 'lazy',
                    widths: '500, 600, 700, 800, 1000, 1200, 1400, 1600, 1800, 2000',
                    class: 'shop-the-look__image hidden-pocket',
                    reveal: true
                  }}
                {%- endif -%}
                
                {%- if block.settings.mobile_image != blank -%}
                  {{ block.settings.mobile_image | image_url: width: 1000 | image_tag:
                    loading: 'lazy',
                    widths: '500, 600, 700, 800, 1000',
                    class: 'shop-the-look__image hidden-lap-and-up',
                    reveal: true
                  }}
                {%- endif -%}
              </div>
              
              {%- for i in (1..3) -%}
                {%- assign product_setting = 'product_' | append: i -%}
                {%- assign product = block.settings[product_setting] -%}
                
                {%- if product != blank -%}
                  <div id="block-{{ block.id }}-{{ i }}" class="shop-the-look__product-wrapper">
                    
                    <button type="button" 
                            is="toggle-button" 
                            reveal 
                            class="shop-the-look__dot tap-area hidden-phone" 
                            aria-controls="block-{{ block.id }}-{{ i }}-product" 
                            aria-expanded="false">
                      <span class="visually-hidden">{{ 'general.shop_the_look.show_product' | t: product: product.title }}</span>
                    </button>
                    
                    <button type="button" 
                            is="toggle-button" 
                            reveal 
                            class="shop-the-look__dot tap-area hidden-tablet-and-up" 
                            aria-controls="block-{{ block.id }}-{{ i }}-popover" 
                            aria-expanded="false">
                      <span class="visually-hidden">{{ 'general.shop_the_look.show_product' | t: product: product.title }}</span>
                    </button>
                    
                    <openable-element id="block-{{ block.id }}-{{ i }}-product" 
                                      class="shop-the-look__product {% if i == 2 or i == 3 %}shop-the-look__product--reverse{% endif %} hidden-phone">
                      {%- if product.featured_image -%}
                        {{ product.featured_image | image_url: width: 288 | image_tag:
                          loading: 'lazy',
                          widths: '72, 144, 216, 288',
                          sizes: '72px',
                          class: 'shop-the-look__product-image'
                        }}
                      {%- endif -%}
                      
                      <div class="shop-the-look__product-info">
                        <a href="{{ product.url }}" class="shop-the-look__product-title">{{ product.title }}</a>
                        
                        <div class="shop-the-look__product-bottom-wrapper">
                          <div class="price">
                            <span class="visually-hidden">{{ 'products.product.price.sale_price' | t }}</span>
                            {{ product.price | money }}
                            {%- if product.compare_at_price > product.price -%}
                              <span class="price price--compare" style="margin-left:5px;">
                                {{ product.compare_at_price | money }}
                              </span>
                            {%- endif -%}
                          </div>
                          
                          <button is="toggle-button" 
                                  class="shop-the-look__product-link link text--subdued" 
                                  aria-controls="block-{{ block.id }}-{{ i }}-drawer" 
                                  aria-expanded="false">
                            {{ 'products.product.quick_view' | t }}
                          </button>
                        </div>
                      </div>
                    </openable-element>
                    
                    <quick-buy-popover 
                      href="{{ product.url }}?view=quick-buy-popover" 
                      id="block-{{ block.id }}-{{ i }}-popover" 
                      class="popover popover--quick-buy">
                    </quick-buy-popover>
                    
                    <quick-buy-drawer 
                      href="{{ product.url }}?view=quick-buy-drawer" 
                      id="block-{{ block.id }}-{{ i }}-drawer" 
                      class="drawer drawer--large drawer--quick-buy">
                    </quick-buy-drawer>
                  </div>
                {%- endif -%}
              {%- endfor -%}
            </shop-the-look-item>
        {%- endcase -%}
      {%- endfor -%}
    </div>
    
    <div class="container">
      <shop-the-look-nav reveal class="shop-the-look__nav">
        <span class="shop-the-look__label heading heading--small hidden-pocket">
          {{ section.settings.heading | default: 'Shop the looks' }}
        </span>
        
        <div class="shop-the-look__prev-next-buttons">
          <button class="shop-the-look__arrow prev-next-button prev-next-button--prev" data-action="prev">
            <span class="visually-hidden">{{ 'general.slider.previous' | t }}</span>
            {%- render 'icon', icon: 'nav-arrow-left' -%}
          </button>
          
          <span class="shop-the-look__counter hidden-pocket">
            <span class="shop-the-look__counter-page">
              <span class="shop-the-look__counter-page-base">1</span>
              {%- for i in (1..section.blocks.size) -%}
                <span class="shop-the-look__counter-page-transition" {% unless forloop.first %}hidden{% endunless %}>{{ i }}</span>
              {%- endfor -%}
            </span>
            <span class="shop-the-look__counter-separator">/</span>
            <span class="shop-the-look__counter-total">{{ section.blocks.size }}</span>
          </span>
          
          <button class="shop-the-look__arrow prev-next-button prev-next-button--next" data-action="next">
            <span class="visually-hidden">{{ 'general.slider.next' | t }}</span>
            {%- render 'icon', icon: 'nav-arrow-right' -%}
          </button>
        </div>
      </shop-the-look-nav>
    </div>
  </shop-the-look>
</section>

{% schema %}
{
  "name": "Shop the look",
  "tag": "section",
  "class": "section-shop-the-look",
  "max_blocks": 10,
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Shop the looks"
    },
    {
      "type": "header",
      "content": "Section padding"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Top padding",
      "default": 36
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Bottom padding",
      "default": 36
    }
  ],
  "blocks": [
    {
      "type": "look",
      "name": "Look",
      "settings": [
        {
          "type": "image_picker",
          "id": "desktop_image",
          "label": "Desktop image",
          "info": "2160 x 1000px recommended"
        },
        {
          "type": "image_picker",
          "id": "mobile_image",
          "label": "Mobile image",
          "info": "1000 x 850px recommended"
        },
        {
          "type": "header",
          "content": "Dot styling"
        },
        {
          "type": "color",
          "id": "dot_inner_color",
          "label": "Dot inner color",
          "default": "#FFFFFF"
        },
        {
          "type": "color",
          "id": "dot_background_color",
          "label": "Dot background color",
          "default": "red"
        },
        {
          "type": "header",
          "content": "Product 1"
        },
        {
          "type": "product",
          "id": "product_1",
          "label": "Product"
        },
        {
          "type": "range",
          "id": "hotspot_1_x",
          "min": 0,
          "max": 100,
          "step": 1,
          "unit": "%",
          "label": "Desktop horizontal position",
          "default": 25
        },
        {
          "type": "range",
          "id": "hotspot_1_y",
          "min": 0,
          "max": 100,
          "step": 1,
          "unit": "%",
          "label": "Desktop vertical position",
          "default": 50
        },
        {
          "type": "range",
          "id": "hotspot_1_mobile_x",
          "min": 0,
          "max": 100,
          "step": 1,
          "unit": "%",
          "label": "Mobile horizontal position",
          "default": 25
        },
        {
          "type": "range",
          "id": "hotspot_1_mobile_y",
          "min": 0,
          "max": 100,
          "step": 1,
          "unit": "%",
          "label": "Mobile vertical position",
          "default": 50
        },
        {
          "type": "header",
          "content": "Product 2"
        },
        {
          "type": "product",
          "id": "product_2",
          "label": "Product"
        },
        {
          "type": "range",
          "id": "hotspot_2_x",
          "min": 0,
          "max": 100,
          "step": 1,
          "unit": "%",
          "label": "Desktop horizontal position",
          "default": 50
        },
        {
          "type": "range",
          "id": "hotspot_2_y",
          "min": 0,
          "max": 100,
          "step": 1,
          "unit": "%",
          "label": "Desktop vertical position",
          "default": 50
        },
        {
          "type": "range",
          "id": "hotspot_2_mobile_x",
          "min": 0,
          "max": 100,
          "step": 1,
          "unit": "%",
          "label": "Mobile horizontal position",
          "default": 50
        },
        {
          "type": "range",
          "id": "hotspot_2_mobile_y",
          "min": 0,
          "max": 100,
          "step": 1,
          "unit": "%",
          "label": "Mobile vertical position",
          "default": 50
        },
        {
          "type": "header",
          "content": "Product 3"
        },
        {
          "type": "product",
          "id": "product_3",
          "label": "Product"
        },
        {
          "type": "range",
          "id": "hotspot_3_x",
          "min": 0,
          "max": 100,
          "step": 1,
          "unit": "%",
          "label": "Desktop horizontal position",
          "default": 75
        },
        {
          "type": "range",
          "id": "hotspot_3_y",
          "min": 0,
          "max": 100,
          "step": 1,
          "unit": "%",
          "label": "Desktop vertical position",
          "default": 50
        },
        {
          "type": "range",
          "id": "hotspot_3_mobile_x",
          "min": 0,
          "max": 100,
          "step": 1,
          "unit": "%",
          "label": "Mobile horizontal position",
          "default": 75
        },
        {
          "type": "range",
          "id": "hotspot_3_mobile_y",
          "min": 0,
          "max": 100,
          "label": "Mobile vertical position",
          "default": 50
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Shop the look",
      "blocks": [
        {
          "type": "look",
          "settings": {
            "dot_inner_color": "blue",
            "dot_background_color": "255, 255, 255",
            "hotspot_1_x": 33,
            "hotspot_1_y": 58,
            "hotspot_1_mobile_x": 31,
            "hotspot_1_mobile_y": 59,
            "hotspot_2_x": 52,
            "hotspot_2_y": 49,
            "hotspot_2_mobile_x": 54,
            "hotspot_2_mobile_y": 44,
            "hotspot_3_x": 60,
            "hotspot_3_y": 80,
            "hotspot_3_mobile_x": 76,
            "hotspot_3_mobile_y": 64
          }
        },
        {
          "type": "look",
          "settings": {
            "dot_inner_color": "blue",
            "dot_background_color": "255, 255, 255",
            "hotspot_1_x": 33,
            "hotspot_1_y": 71,
            "hotspot_1_mobile_x": 45,
            "hotspot_1_mobile_y": 62,
            "hotspot_2_x": 49,
            "hotspot_2_y": 37,
            "hotspot_2_mobile_x": 62,
            "hotspot_2_mobile_y": 39,
            "hotspot_3_x": 70,
            "hotspot_3_y": 70,
            "hotspot_3_mobile_x": 70,
            "hotspot_3_mobile_y": 70
          }
        },
        {
          "type": "look",
          "settings": {
            "dot_inner_color": "blue",
            "dot_background_color": "255, 255, 255",
            "hotspot_1_x": 60,
            "hotspot_1_y": 50,
            "hotspot_1_mobile_x": 54,
            "hotspot_1_mobile_y": 56,
            "hotspot_2_x": 43,
            "hotspot_2_y": 50,
            "hotspot_2_mobile_x": 41,
            "hotspot_2_mobile_y": 50,
            "hotspot_3_x": 62,
            "hotspot_3_y": 62,
            "hotspot_3_mobile_x": 69,
            "hotspot_3_mobile_y": 64
          }
        },
        {
          "type": "look",
          "settings": {
            "dot_inner_color": "blue",
            "dot_background_color": "255, 255, 255",
            "hotspot_1_x": 10,
            "hotspot_1_y": 59,
            "hotspot_1_mobile_x": 32,
            "hotspot_1_mobile_y": 59,
            "hotspot_2_x": 46,
            "hotspot_2_y": 50,
            "hotspot_2_mobile_x": 50,
            "hotspot_2_mobile_y": 69,
            "hotspot_3_x": 70,
            "hotspot_3_y": 70,
            "hotspot_3_mobile_x": 70,
            "hotspot_3_mobile_y": 70
          }
        },
        {
          "type": "look",
          "settings": {
            "dot_inner_color": "blue",
            "dot_background_color": "255, 255, 255",
            "hotspot_1_x": 14,
            "hotspot_1_y": 62,
            "hotspot_1_mobile_x": 19,
            "hotspot_1_mobile_y": 48,
            "hotspot_2_x": 50,
            "hotspot_2_y": 66,
            "hotspot_2_mobile_x": 50,
            "hotspot_2_mobile_y": 50,
            "hotspot_3_x": 84,
            "hotspot_3_y": 70,
            "hotspot_3_mobile_x": 87,
            "hotspot_3_mobile_y": 50
          }
        }
      ]
    }
  ]
}
{% endschema %} {% endcomment %}